"use strict";let shows=[],favs=[];const input=document.querySelector(".js-search__input"),searchButton=document.querySelector(".js-search__button"),showsList=document.querySelector(".js-shows__list"),favsList=document.querySelector(".js-favs__list");function getServerData(s){let t=input.value;s.preventDefault(),fetch(`http://api.tvmaze.com/search/shows?q=${t}`).then(function(s){return s.json()}).then(function(s){shows=s,paintShows(),listenShows()}).catch(function(s){console.log("Error al traer los datos del servidor",s)})}function paintShows(){let s="";for(let t=0;t<shows.length;t++){let e=shows[t].show.name,a=shows[t].show.id,o=shows[t].show.image;s+=`<li class="js-show__item" id=${a}>`,s+=`<h2>${e}</h2>`,s+=`<img src="${o=null===o?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":o.medium}"/>`,s+="</li>"}showsList.innerHTML=s}function listenShows(){const s=document.querySelectorAll(".js-show__item");for(const t of s)t.addEventListener("click",addFav)}function addFav(s){const t=parseInt(s.currentTarget.id);if(favs.find(function(s){if(s.show.id===t)return!0})){const s=favs.findIndex(function(s){if(s.show.id===t)return!0});favs.splice(s,1),console.log("Lo saco")}else{const s=shows.find(function(s){if(s.show.id===t)return!0});favs.push(s),console.log(favs)}paintFavs(),setFavData()}function paintFavs(){let s="";for(let t=0;t<favs.length;t++){let e=favs[t].show.name,a=favs[t].show.id,o=favs[t].show.image;s+=`<li class="fav__item js-fav__item" id=${a}>`,s+='<div class="fav__item__header">',s+=`<h2 class="fav__title">${e}</h2>`,s+='<p class="fav__close js-fav__close">X</p>',s+="</div>",s+=`<img class="fav__img" src="${o=null===o?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":o.medium}"/>`,s+="</li>"}favsList.innerHTML=s}function setFavData(){localStorage.setItem("favs",JSON.stringify(favs))}function getFavData(){const s=localStorage.getItem("favs"),t=JSON.parse(s);null!==t&&(favs=t,paintFavs())}searchButton.addEventListener("click",getServerData),getFavData();