"use strict";let shows=[],favs=[];const input=document.querySelector(".js-search__input"),searchButton=document.querySelector(".js-search__button"),showsList=document.querySelector(".js-shows__list"),favsList=document.querySelector(".js-favs__list"),showItems=document.querySelectorAll(".js-show__item"),resetButton=document.querySelector(".reset__btn");function getServerData(t){let s=input.value;t.preventDefault(),fetch(`http://api.tvmaze.com/search/shows?q=${s}`).then(function(t){return t.json()}).then(function(t){shows=t,paintShows(),listenShows()}).catch(function(t){console.log("Error al traer los datos del servidor",t)})}function paintShows(){let t="";for(let s=0;s<shows.length;s++){let e=shows[s].show.name,a=shows[s].show.id,n=shows[s].show.image;const o=-1!==favs.findIndex(function(t){return t.show.id===a});n=null===n?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":n.medium,t+=o?`<li class="show__item js-show__item show__item__fav" id=${a}>`:`<li class="show__item js-show__item" id=${a}>`,t+=`<h2 class="show__item__title">${e}</h2>`,t+=`<img src="${n}"/>`,t+="</li>"}showsList.innerHTML=t}function listenShows(){const t=document.querySelectorAll(".js-show__item");for(const s of t)s.addEventListener("click",addFav)}function listenFavs(){const t=document.querySelectorAll(".js-fav__item");for(const s of t)s.addEventListener("click",addFav)}function addFav(t){const s=parseInt(t.currentTarget.id);if(favs.find(function(t){if(t.show.id===s)return!0})){const t=favs.findIndex(function(t){if(t.show.id===s)return!0});favs.splice(t,1)}else{const t=shows.find(function(t){if(t.show.id===s)return!0});favs.push(t)}paintShows(),listenShows(),paintFavs(),setFavData()}function paintFavs(){let t="";for(let s=0;s<favs.length;s++){let e=favs[s].show.name,a=favs[s].show.id,n=favs[s].show.image;t+='<li class="fav__item">',t+='<div class="fav__item__header">',t+=`<h2 class="fav__title">${e}</h2>`,t+=`<i class="js-trash fas fa-trash js-fav__item" id="${a}"></i>`,t+="</div>",t+=`<img class="fav__img" src="${n=null===n?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":n.medium}"/>`,t+="</li>"}favsList.innerHTML=t,listenFavs()}function setFavData(){localStorage.setItem("favs",JSON.stringify(favs))}function getFavData(){const t=localStorage.getItem("favs"),s=JSON.parse(t);null!==s&&(favs=s,paintFavs())}function resetFavs(t){t.preventDefault(),favs=[],paintFavs(),setFavData()}searchButton.addEventListener("click",getServerData),resetButton.addEventListener("click",resetFavs),getFavData();